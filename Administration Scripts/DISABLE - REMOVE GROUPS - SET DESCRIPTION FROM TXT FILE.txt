$date = Get-Date
$Users = Get-Content C:\tmp\offboarding.txt
foreach ($User in $Users) {
  Write-Host "User is: $User`n" -ForegroundColor Green
  try {
  Set-ADUser -Identity $User -Description "Separation on $date" -Enabled $false
  Write-Host "  $User description set.`n" -ForegroundColor Green
  Write-Host "  $User disabled.`n" -ForegroundColor LightGreen
  } catch {
    Write-Host "ERROR in SET USER" -ForegroundColor Red
  }
  try {
    $UserGroups = Get-ADUser -Identity $User -Properties MemberOf
    $GroupOutput = $UserGroups | select -ExpandProperty MemberOf | Get-ADGroup | select name
    Write-Host "Grabbing $User groups: $($GroupOutput)" -ForegroundColor Green
    $UserGroups.MemberOf | Remove-ADGroupMember -Member $User -Confirm:$false
    Write-Host "`n$User groups removed.`n" -ForegroundColor Green
  } catch {
    Write-Host "ERROR in REMOVE GROUPS" -ForegroundColor Red
  }
}